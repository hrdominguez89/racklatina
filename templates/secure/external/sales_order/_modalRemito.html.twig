{% if remitos is not empty %}
        <div class="row mb-3">
            <div class="col-md-6">
                {# <p><strong>DB Schema ID:</strong> {{ remito.dbschemaid ?? 'N/A' }}</p> #}
                <p><strong>Fecha:</strong> {{ remitos[0].fecha ? remitos[0].fecha|date('d/m/Y') : 'N/A' }}</p>
                <p><strong>Remito:</strong> {{ remitos[0].remito ?? 'N/A' }}</p>
                <p><strong>Razón Social:</strong> {{ remitos[0].razonSocial ?? 'N/A' }}</p>
            </div>
            <div class="col-md-6">
            </div>
        </div>
        <div class="row">
            <div class="d-flex justify-content-end mb-3">
                <button class="btn btn-primary" id="btnDescargarRemito" data-remito="{{ remitos[0].remito }}">
                    Descargar PDF
                </button>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table table-bordered table-sm small">
                <thead class="text-center">
                    <tr >
                        <th>Codigo articulo</th>
                        <th>Nombre articulo</th>
                        <th title="Servicio">Serv.</th>
                        <th>Cotizacion</th>
                        <th>Moneda</th>
                        <th>Entregado</th>
                        <th>Facturado</th>
                        <th>Pendiente</th>
                        <th title="Nombre del comprobante">Comprobante</th>
                        <th title="Tipo de comprobante">Tipo</th>
                    </tr>
                </thead>
                <tbody>
                    {% for remito in remitos %}
                        <tr>
                            <td  class="text-center">{{ remito.codigoArticulo }}</td>
                            <td >{{ remito.nombreArticulo }}</td>
                            <td  class="text-center">{{ remito.servicio }}</td>
                            <td  class="text-center">$&nbsp;{{ remito.cotizacion|number_format(2, ',', '.') }}</td>
                            <td >{{ remito.moneda }}</td>
                            <td class="text-center">{{ remito.entregado }}</td>
                            <td class="text-center">{{ remito.facturado }}</td>
                            <td class="text-center">{{ remito.pendiente }}</td>
                            <td  class="text-center">{{ remito.nombreComprobante }}</td>
                            <td  class="text-center">{{ remito.tipoComprobante }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <script>
       // JavaScript/jQuery
$(document).ready(function() {
    $('#btnDescargarRemito').on('click', function() {
        const remito = $(this).data('remito');
        const url = "{{ path('app_remitos_descarga') }}?remito=" + remito;

        // Deshabilitar botón durante la descarga
        const $btn = $(this);
        $btn.prop('disabled', true);

        fetch(url)
            .then(response => {
                if (!response.ok) {
                    // Si hay error, parsear el JSON con el mensaje
                    return response.json().then(data => {
                        throw new Error(data.message || 'Error al descargar el remito');
                    });
                }
                return response.blob();
            })
            .then(blob => {
                // Crear descarga con blob
                const urlBlob = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = urlBlob;
                link.download = remito + '.pdf';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(urlBlob);
            })
            .catch(error => {
                Swal.fire('Error', error.message, 'error');
            })
            .finally(() => {
                $btn.prop('disabled', false);
            });
    });
});
        </script>
{% else %}
    <div class="alert alert-info">
        No se encontraron datos para el remito #{{ numero }}
    </div>
{% endif %}


